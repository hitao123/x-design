@use '../../theme/src/mixins/table.scss' as *;

.x-table {
  @include table-base;

  &--small {
    @include table-size(var(--x-table-small-padding, 8px 8px));
  }

  &--medium {
    @include table-size(var(--x-table-medium-padding, 12px 16px));
  }

  &--large {
    @include table-size(var(--x-table-large-padding, 16px 16px));
  }

  &--border {
    @include table-border;
  }

  &--stripe {
    .x-table__row--striped {
      background-color: var(--x-table-stripe-bg, #fafafa);
    }
  }

  &--loading {
    position: relative;
  }
}

.x-table__loading {
  @include table-loading;
}

.x-table__container {
  @include table-container;
}

.x-table__element {
  @include table-element;

  th,
  td {
    padding: var(--x-table-medium-padding, 12px 16px);
    border-bottom: 1px solid var(--x-table-border-color, #ebeef5);
    text-align: left;
    vertical-align: middle;
  }
}

.x-table tr {
  border-top: none;
  background-color: transparent;
}

.x-table__header {
  @include table-header;
}

.x-table__body {
  @include table-body;
}

.x-table__row {
  @include table-row;

  &--current {
    background-color: var(--x-table-current-row-bg, #ecf5ff);
  }

  &--selected {
    background-color: var(--x-color-primary-light-9, #ecf5ff);
  }
}

.x-table__cell {
  @include table-cell;

  &--left {
    text-align: left;
  }

  &--center {
    text-align: center;
  }

  &--right {
    text-align: right;
  }

  &.is-fixed {
    background-color: inherit;
  }

  &.is-sortable {
    cursor: pointer;
    user-select: none;

    &:hover {
      background-color: var(--x-table-header-hover-bg, #f2f6fc);
    }
  }
}

.x-table__cell-content {
  display: flex;
  align-items: center;
  gap: 4px;
}

.x-table__empty {
  &:hover {
    background-color: transparent !important;
  }

  td {
    text-align: center;
    color: var(--x-text-color-secondary, #909399);
    padding: var(--x-spacing-xl, 20px) 0;
  }
}

.x-table__empty-text {
  padding: 40px 0;
  text-align: center;
  color: var(--x-text-color-secondary, #909399);
  font-size: var(--x-font-size-base, 14px);
}

// 排序图标
.x-table__sort-icons {
  display: inline-flex;
  flex-direction: column;
  margin-left: 4px;
  cursor: pointer;
}

.x-table__sort-icon {
  font-size: 10px;
  line-height: 1;
  color: var(--x-text-color-placeholder);
  transition: color var(--x-transition-duration);

  &.is-active {
    color: var(--x-color-primary);
  }

  &--asc {
    margin-bottom: -2px;
  }

  &--desc {
    margin-top: -2px;
  }
}

// 展开图标
.x-table__expand-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  font-size: 10px;
  cursor: pointer;
  transition: transform var(--x-transition-duration);
  color: var(--x-text-color-regular);

  &.is-expanded {
    transform: rotate(90deg);
  }

  &:hover {
    color: var(--x-color-primary);
  }
}

.x-table__expand-row {
  &:hover {
    background-color: transparent;
  }

  td {
    padding: 12px 20px;
  }
}

// 树形单元格
.x-table__tree-cell {
  display: flex;
  align-items: center;
  gap: 4px;
}

// 复选框样式
input[type="checkbox"] {
  cursor: pointer;
  width: 16px;
  height: 16px;
  accent-color: var(--x-color-primary);
}

// 固定列滚动阴影
.x-table__cell.is-fixed {
  background-color: inherit;

  &::after {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    width: 10px;
    pointer-events: none;
    transition: box-shadow 0.3s;
  }
}

.x-table__container.is-scrolling {
  .x-table__cell.is-fixed[style*="left"] {
    &::after {
      right: -10px;
      box-shadow: inset 10px 0 8px -8px rgba(0, 0, 0, 0.12);
    }
  }
  .x-table__cell.is-fixed[style*="right"] {
    &::after {
      left: -10px;
      box-shadow: inset -10px 0 8px -8px rgba(0, 0, 0, 0.12);
    }
  }
}

// 筛选相关
.x-table-filter {
  display: inline-flex;
  align-items: center;
  margin-left: 4px;
}

.x-table-filter__trigger {
  cursor: pointer;
  padding: 2px;
}

.x-table-filter__icon {
  font-size: 10px;
  color: var(--x-text-color-placeholder);
  transition: color var(--x-transition-duration);

  &.is-active {
    color: var(--x-color-primary);
  }
}

.x-table-filter__panel {
  background: var(--x-bg-color);
  border: 1px solid var(--x-table-border-color, #ebeef5);
  border-radius: var(--x-border-radius-base);
  box-shadow: var(--x-box-shadow-light);
  min-width: 120px;
  overflow: hidden;
}

.x-table-filter__list {
  list-style: none;
  padding: 4px 0;
  margin: 0;
  max-height: 200px;
  overflow-y: auto;
}

.x-table-filter__item {
  padding: 6px 12px;
  font-size: var(--x-font-size-sm);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  transition: background-color var(--x-transition-duration);

  &:hover {
    background-color: var(--x-bg-color-page);
  }

  &.is-active {
    color: var(--x-color-primary);
    font-weight: 500;
  }
}

.x-table-filter__footer {
  display: flex;
  justify-content: space-between;
  padding: 6px 12px;
  border-top: 1px solid var(--x-table-border-color, #ebeef5);
}

.x-table-filter__btn {
  padding: 2px 8px;
  font-size: var(--x-font-size-sm);
  border: none;
  background: none;
  cursor: pointer;
  color: var(--x-text-color-regular);
  border-radius: var(--x-border-radius-small);

  &:hover {
    color: var(--x-color-primary);
  }

  &--primary {
    color: var(--x-color-primary);
    font-weight: 500;
  }
}

.x-table-filter-fade-enter-active,
.x-table-filter-fade-leave-active {
  transition: opacity 0.2s, transform 0.2s;
}

.x-table-filter-fade-enter-from,
.x-table-filter-fade-leave-to {
  opacity: 0;
  transform: scaleY(0.8);
  transform-origin: top;
}

// 分页
.x-table__pagination {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  padding: 12px 0;
  gap: 12px;
  font-size: var(--x-font-size-sm);
}

.x-table__pagination-total {
  color: var(--x-text-color-regular);
}

.x-table__pagination-pager {
  display: flex;
  gap: 4px;
}

.x-table__pagination-btn {
  min-width: 28px;
  height: 28px;
  padding: 0 6px;
  border: 1px solid var(--x-border-color);
  border-radius: var(--x-border-radius-small);
  background: var(--x-bg-color);
  color: var(--x-text-color-regular);
  cursor: pointer;
  font-size: var(--x-font-size-sm);
  transition: all var(--x-transition-duration);

  &:hover:not(:disabled) {
    color: var(--x-color-primary);
    border-color: var(--x-color-primary);
  }

  &.is-active {
    background: var(--x-color-primary);
    color: #fff;
    border-color: var(--x-color-primary);
  }

  &:disabled {
    cursor: not-allowed;
    opacity: 0.5;
  }
}
